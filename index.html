<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sound Bear - 音声作品制作ツール</title>
    <link rel="stylesheet" href="main.css">
    <link rel="stylesheet" href="theme.css">
    <link rel="stylesheet" href="responsive.css">
    <link rel="stylesheet" href="effects-collapse.css">
    <link rel="stylesheet" href="help.css">
</head>
<body>
    <div id="app">
        <!-- ヘッダー -->
        <header class="app-header">
            <div class="header-left">
                <h1 class="app-title">
                    <img src="user-icon.png" alt="🐻" class="app-icon">
                    Sound Bear
                </h1>
                <div class="project-info">
                    <input type="text" id="projectName" class="project-name-input" value="新規プロジェクト" title="クリックして編集">
                </div>
            </div>
            <div class="header-controls">
                <button class="btn btn-secondary history-btn" id="undoBtn" disabled title="元に戻す (Ctrl/Cmd+Z)">
                    <img src="undo.png" alt="元に戻す" class="history-icon">
                </button>
                <button class="btn btn-secondary history-btn" id="redoBtn" disabled title="やり直す (Ctrl/Cmd+Y)">
                    <img src="redo.png" alt="やり直す" class="history-icon">
                </button>
                <button class="btn btn-primary" id="newProjectBtn">新規</button>
                <button class="btn btn-primary" id="saveProjectBtn">保存</button>
                <button class="btn btn-primary" id="loadProjectBtn">読込</button>
                <button class="btn btn-success" id="exportBtn">書き出し</button>
                <button class="btn btn-help" id="helpBtn" title="使い方">?</button>
            </div>
        </header>

        <!-- メインコンテンツ -->
        <div class="main-container">
            <!-- サイドバー（ファイルブラウザ） -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <img src="gorone-bear.png" alt="🐻" class="sidebar-bear">
                    <button class="btn btn-primary btn-icon" id="deleteFilesBtn" title="選択したファイルを削除">-</button>
                    <button class="btn btn-primary btn-icon" id="importFilesBtn">+</button>
                </div>
                <div class="file-tabs">
                    <button class="tab-btn active" data-tab="dialogue">台詞</button>
                    <button class="tab-btn" data-tab="sfx">SE</button>
                    <button class="tab-btn" data-tab="bgm">BGM</button>
                    <button class="tab-btn" data-tab="ambience">ME</button>
                    <button class="tab-btn" data-tab="effects">その他</button>
                </div>
                <div class="file-list-container">
                    <div class="file-list active" id="dialogue-list"></div>
                    <div class="file-list" id="sfx-list"></div>
                    <div class="file-list" id="bgm-list"></div>
                    <div class="file-list" id="ambience-list"></div>
                    <div class="file-list" id="effects-list"></div>
                </div>
            </aside>

            <!-- タイムラインエリア -->
            <main class="timeline-container">
                <!-- トランスポートコントロール -->
                <div class="transport-controls">
                    <button class="transport-btn" id="playBtn">
                        <img src="play.png" alt="再生" class="transport-icon">
                    </button>
                    <button class="transport-btn" id="pauseBtn">
                        <img src="pause.png" alt="一時停止" class="transport-icon">
                    </button>
                    <button class="transport-btn" id="stopBtn">
                        <img src="stop.png" alt="停止" class="transport-icon">
                    </button>
                    <div class="time-display">
                        <span id="currentTime">00:00.000</span>
                        <span>/</span>
                        <span id="totalTime">00:00.000</span>
                    </div>
                    <div class="zoom-controls">
                        <button class="btn btn-small" id="zoomInBtn">+</button>
                        <button class="btn btn-small" id="zoomOutBtn">-</button>
                        <button class="btn btn-small" id="fitBtn">全体</button>
                    </div>
                </div>

                <!-- タイムライン -->
                <div class="timeline-area" id="timelineArea">
                    <div class="timeline-header">
                        <div class="track-header-column">トラック</div>
                        <div class="timeline-ruler" id="timelineRuler"></div>
                    </div>
                    <div class="tracks-container" id="tracksContainer">
                        <!-- トラックが動的に追加される -->
                    </div>
                </div>

                <!-- トラック追加ボタン -->
                <div class="track-actions">
                    <button class="btn btn-primary" id="addTrackBtn">+ トラック追加</button>
                    <span class="track-count">トラック数: <span id="trackCount">0</span>/30</span>
                </div>
            </main>

            <!-- エフェクトパネル -->
            <aside class="effects-panel" id="effectsPanel">
                <div class="panel-header">
                    <h2>🎛️ エフェクト</h2>
                    <button class="btn-close" id="closeEffectsBtn">✕</button>
                </div>
                <div class="effects-content">
                    <div class="effect-section">
                        <h3>イコライザー</h3>
                        <div class="eq-controls">
                            <div class="control-row">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="trackEQEnabled">
                                    <span>イコライザーを有効化</span>
                                </label>
                            </div>
                            <div class="eq-presets">
                                <button class="btn btn-small eq-preset-btn" data-preset="flat" disabled>フラット</button>
                                <button class="btn btn-small eq-preset-btn" data-preset="phone" disabled>電話風</button>
                                <button class="btn btn-small eq-preset-btn" data-preset="clear" disabled>クリア</button>
                                <button class="btn btn-small eq-preset-btn" data-preset="wall" disabled>壁越し</button>
                            </div>
                            <div class="control-row">
                                <label>Low (100Hz)</label>
                                <input type="range" id="eqLow" min="-24" max="24" value="0" step="0.1" disabled>
                                <span class="control-value">0.0 dB</span>
                            </div>
                            <div class="control-row">
                                <label>Mid (1kHz)</label>
                                <input type="range" id="eqMid" min="-24" max="24" value="0" step="0.1" disabled>
                                <span class="control-value">0.0 dB</span>
                            </div>
                            <div class="control-row">
                                <label>High (10kHz)</label>
                                <input type="range" id="eqHigh" min="-24" max="24" value="0" step="0.1" disabled>
                                <span class="control-value">0.0 dB</span>
                            </div>
                        </div>
                    </div>
                    <div class="effect-section">
                        <h3>リミッター</h3>
                        <div class="limiter-controls">
                            <div class="control-row">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="trackLimiterEnabled">
                                    <span>リミッターを有効化</span>
                                </label>
                            </div>
                            <div class="control-row">
                                <label>Threshold</label>
                                <input type="range" id="trackLimiterThreshold" min="-24" max="0" value="-6" step="0.1" disabled>
                                <span class="control-value">-6 dB</span>
                            </div>
                            <div class="control-row">
                                <label>Release</label>
                                <input type="range" id="trackLimiterRelease" min="10" max="1000" value="250" step="10" disabled>
                                <span class="control-value">250 ms</span>
                            </div>
                            <div class="control-row">
                                <label>Ratio</label>
                                <input type="range" id="trackLimiterRatio" min="1" max="20" value="20" step="0.1" disabled>
                                <span class="control-value">20:1</span>
                            </div>
                        </div>
                    </div>
                    <div class="effect-section">
                        <h3>ホワイトノイズ除去</h3>
                        <div class="expander-controls">
                            <div class="control-row">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="trackExpanderEnabled">
                                    <span>ホワイトノイズ除去を有効化</span>
                                </label>
                            </div>
                            <div class="control-row">
                                <label>Threshold（閾値）</label>
                                <input type="range" id="trackExpanderThreshold" min="-60" max="-20" value="-40" step="1" disabled>
                                <span class="control-value">-40 dB</span>
                            </div>
                            <div class="control-row">
                                <label>Ratio（比率）</label>
                                <input type="range" id="trackExpanderRatio" min="0.1" max="1" value="0.5" step="0.05" disabled>
                                <span class="control-value">0.50</span>
                            </div>
                            <div class="control-row">
                                <label>Release</label>
                                <input type="range" id="trackExpanderRelease" min="50" max="500" value="250" step="10" disabled>
                                <span class="control-value">250 ms</span>
                            </div>
                            <div class="expander-info">
                                💡 ゲインを上げた音声の"サー"というノイズを軽減<br>
                                💡 Threshold以下の小さい音をさらに小さくします<br>
                                💡 Ratioが小さいほど強力な効果
                            </div>
                        </div>
                    </div>
                    <div class="effect-section">
                        <h3>帯域カット</h3>
                        <div class="noisereduction-controls">
                            <div class="control-row">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="trackNoiseReductionEnabled">
                                    <span>帯域カットを有効化</span>
                                </label>
                            </div>
                            
                            <!-- ハイパスフィルタ -->
                            <div class="filter-subsection">
                                <h4>🔉 ハイパスフィルタ（低音カット）</h4>
                                <div class="control-row">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="trackHighpassEnabled">
                                        <span>有効化</span>
                                    </label>
                                </div>
                                <div class="control-row">
                                    <label>カットオフ周波数</label>
                                    <input type="range" id="trackHighpassCutoff" min="20" max="500" value="80" step="5" disabled>
                                    <span class="control-value">80 Hz</span>
                                </div>
                                <div class="control-row">
                                    <label>レゾナンス (Q)</label>
                                    <input type="range" id="trackHighpassResonance" min="0.1" max="10" value="0.7" step="0.1" disabled>
                                    <span class="control-value">0.7</span>
                                </div>
                            </div>
                            
                            <!-- ローパスフィルタ -->
                            <div class="filter-subsection">
                                <h4>🔊 ローパスフィルタ（高音カット）</h4>
                                <div class="control-row">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="trackLowpassEnabled">
                                        <span>有効化</span>
                                    </label>
                                </div>
                                <div class="control-row">
                                    <label>カットオフ周波数</label>
                                    <input type="range" id="trackLowpassCutoff" min="1000" max="20000" value="8000" step="100" disabled>
                                    <span class="control-value">8000 Hz</span>
                                </div>
                                <div class="control-row">
                                    <label>レゾナンス (Q)</label>
                                    <input type="range" id="trackLowpassResonance" min="0.1" max="10" value="0.7" step="0.1" disabled>
                                    <span class="control-value">0.7</span>
                                </div>
                            </div>
                            
                            <div class="filter-info">
                                💡 ハイパス: エアコン音・風切り音などの低音ノイズをカット<br>
                                💡 ローパス: サーッという高音ノイズをカット
                            </div>
                        </div>
                    </div>
                </div>
            </aside>
        </div>
    </div>

    <!-- モーダル：プロジェクト管理 -->
    <div class="modal" id="projectModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>プロジェクト管理</h2>
                <button class="btn-close" id="closeProjectModal">✕</button>
            </div>
            <div class="modal-body">
                <div class="project-list" id="projectList">
                    <!-- プロジェクト一覧が表示される -->
                </div>
            </div>
        </div>
    </div>

    <!-- モーダル:書き出し -->
    <div class="modal" id="exportModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>書き出し設定</h2>
                <button class="btn-close" id="closeExportModal">✕</button>
            </div>
            <div class="modal-body">
                <div class="export-options">
                    <div class="option-group">
                        <label>ファイル形式</label>
                        <select id="exportFormat" class="form-select">
                            <option value="wav">WAV (非圧縮)</option>
                            <option value="mp3">MP3 (圧縮)</option>
                        </select>
                    </div>
                    <div class="option-group">
                        <label>サンプルレート</label>
                        <select id="exportSampleRate" class="form-select">
                            <option value="44100">44.1 kHz</option>
                            <option value="48000" selected>48 kHz</option>
                            <option value="96000">96 kHz</option>
                        </select>
                    </div>
                    <div class="option-group">
                        <label>ビットデプス</label>
                        <select id="exportBitDepth" class="form-select">
                            <option value="16">16 bit</option>
                            <option value="24" selected>24 bit</option>
                            <option value="32">32 bit float</option>
                        </select>
                    </div>
                </div>
                <button class="btn btn-success btn-large" id="startExportBtn">書き出し開始</button>
            </div>
        </div>
    </div>

    <!-- モーダル:使い方 -->
    <div class="modal" id="helpModal">
        <div class="modal-content modal-help">
            <div class="modal-header">
                <h2>🐻 Sound Bear 使い方ガイド</h2>
                <button class="btn-close" id="closeHelpModal">✕</button>
            </div>
            <div class="modal-body">
                <div class="help-tabs">
                    <button class="help-tab-btn active" data-help-tab="basic">基本操作</button>
                    <button class="help-tab-btn" data-help-tab="timeline">タイムライン編集</button>
                    <button class="help-tab-btn" data-help-tab="effects">エフェクト</button>
                    <button class="help-tab-btn" data-help-tab="export">書き出し</button>
                    <button class="help-tab-btn" data-help-tab="tips">便利な機能</button>
                </div>
                
                <div class="help-content-area">
                    <!-- 基本操作 -->
                    <div class="help-content active" data-help-content="basic">
                        <h3>🎯 基本操作</h3>
                        
                        <div class="help-section">
                            <h4>1. 音声ファイルの読み込み</h4>
                            <p>左サイドバーの<strong>「+」ボタン</strong>をクリックして、音声ファイルを読み込みます。</p>
                            <ul>
                                <li>対応形式: MP3, WAV, OGG, M4A</li>
                                <li>複数ファイルの同時読み込みが可能</li>
                                <li>タブで「台詞」「SE」「BGM」「ME」「その他」に分類</li>
                            </ul>
                        </div>
                        
                        <div class="help-section">
                            <h4>2. トラックへの配置</h4>
                            <p>サイドバーのファイルを<strong>タイムラインにドラッグ&ドロップ</strong>して配置します。</p>
                            <ul>
                                <li>ドラッグ中に配置位置がプレビュー表示されます</li>
                                <li>既存のクリップと重ならないように自動調整されます</li>
                            </ul>
                        </div>
                        
                        <div class="help-section">
                            <h4>3. トラックの追加</h4>
                            <p>タイムライン下部の<strong>「+ トラック追加」</strong>ボタンでトラックを追加できます。</p>
                            <ul>
                                <li>最大30トラックまで追加可能</li>
                                <li>各トラックに名前を設定できます</li>
                            </ul>
                        </div>
                        
                        <div class="help-section">
                            <h4>4. プロジェクトの保存</h4>
                            <p>ヘッダーの<strong>「保存」</strong>ボタンでプロジェクトを保存できます。</p>
                            <ul>
                                <li>プロジェクト名をクリックして変更可能</li>
                                <li>ブラウザのローカルストレージに保存されます</li>
                                <li>「読込」ボタンで過去のプロジェクトを復元できます</li>
                            </ul>
                        </div>
                    </div>
                    
                    <!-- タイムライン編集 -->
                    <div class="help-content" data-help-content="timeline">
                        <h3>✂️ タイムライン編集</h3>
                        
                        <div class="help-section">
                            <h4>クリップの移動</h4>
                            <p>クリップをドラッグして、位置を変更できます。</p>
                            <ul>
                                <li><strong>横方向:</strong> 時間位置を変更</li>
                                <li><strong>縦方向:</strong> 異なるトラックへ移動</li>
                                <li>他のクリップとの重なりは自動的に調整されます</li>
                            </ul>
                        </div>
                        
                        <div class="help-section">
                            <h4>トリミング（端のドラッグ）</h4>
                            <p>クリップの<strong>左右の端</strong>をドラッグして、長さを調整できます。</p>
                            <ul>
                                <li>音声の開始・終了位置を変更</li>
                                <li>波形を見ながら正確にトリミング可能</li>
                                <li>元の音声ファイルは変更されません</li>
                            </ul>
                        </div>
                        
                        <div class="help-section">
                            <h4>クリップゲインの調整</h4>
                            <p>クリップを<strong>ダブルクリック</strong>すると、ゲイン調整パネルが表示されます。</p>
                            <ul>
                                <li>±24 dBの範囲で音量を調整</li>
                                <li>現在のピークと調整後のピークを確認できます</li>
                                <li>プリセットボタンで素早く設定可能</li>
                            </ul>
                        </div>
                        
                        <div class="help-section">
                            <h4>再生コントロール</h4>
                            <ul>
                                <li><strong>再生:</strong> ▶ボタンまたはスペースキー</li>
                                <li><strong>一時停止:</strong> ⏸ボタンまたはスペースキー</li>
                                <li><strong>停止:</strong> ⏹ボタン（最初に戻る）</li>
                            </ul>
                        </div>
                        
                        <div class="help-section">
                            <h4>ズーム操作</h4>
                            <ul>
                                <li><strong>+ボタン:</strong> タイムラインを拡大</li>
                                <li><strong>-ボタン:</strong> タイムラインを縮小</li>
                                <li><strong>全体ボタン:</strong> すべてのクリップが表示されるように調整</li>
                            </ul>
                        </div>
                        
                        <div class="help-section">
                            <h4>元に戻す / やり直す</h4>
                            <ul>
                                <li><strong>Ctrl/Cmd + Z:</strong> 元に戻す</li>
                                <li><strong>Ctrl/Cmd + Y:</strong> やり直す</li>
                            </ul>
                        </div>
                    </div>
                    
                    <!-- エフェクト -->
                    <div class="help-content" data-help-content="effects">
                        <h3>🎛️ エフェクト</h3>
                        
                        <div class="help-section">
                            <h4>エフェクトパネルの表示</h4>
                            <p>トラック名の横にある<strong>「⚙️」ボタン</strong>をクリックすると、エフェクトパネルが表示されます。</p>
                        </div>
                        
                        <div class="help-section">
                            <h4>イコライザー (EQ)</h4>
                            <p>音質を調整するためのエフェクトです。</p>
                            <ul>
                                <li><strong>Low (100Hz):</strong> 低音の調整</li>
                                <li><strong>Mid (1kHz):</strong> 中音の調整</li>
                                <li><strong>High (10kHz):</strong> 高音の調整</li>
                            </ul>
                            <p><strong>プリセット:</strong></p>
                            <ul>
                                <li><strong>フラット:</strong> すべて 0 dB (デフォルト)</li>
                                <li><strong>電話風:</strong> 中音域を強調、電話越しの音</li>
                                <li><strong>クリア:</strong> 高音を強調、クリアな音</li>
                                <li><strong>壁越し:</strong> 高音をカット、こもった音</li>
                            </ul>
                        </div>
                        
                        <div class="help-section">
                            <h4>リミッター</h4>
                            <p>音量が大きすぎる部分を抑えるエフェクトです。</p>
                            <ul>
                                <li><strong>Threshold:</strong> 制限を開始する音量レベル</li>
                                <li><strong>Knee:</strong> 制限の掛かり方の滑らかさ</li>
                                <li><strong>Release:</strong> 制限が解除される速度</li>
                            </ul>
                        </div>
                        
                        <div class="help-section">
                            <h4>コンプレッサー</h4>
                            <p>音量差を均一にするエフェクトです。</p>
                            <ul>
                                <li><strong>Threshold:</strong> 圧縮を開始する音量レベル</li>
                                <li><strong>Ratio:</strong> 圧縮の強さ (2:1～20:1)</li>
                                <li><strong>Attack:</strong> 圧縮が掛かる速度</li>
                                <li><strong>Release:</strong> 圧縮が解除される速度</li>
                                <li><strong>Knee:</strong> 圧縮の掛かり方の滑らかさ</li>
                                <li><strong>Makeup Gain:</strong> 圧縮後の音量補正</li>
                            </ul>
                        </div>
                        
                        <div class="help-section">
                            <h4>帯域カット (ノイズリダクション)</h4>
                            <p>特定の周波数帯をカットしてノイズを軽減します。</p>
                            <p><strong>ハイパスフィルタ (低音カット):</strong></p>
                            <ul>
                                <li>エアコン音、風切り音などの低音ノイズを除去</li>
                                <li>カットオフ周波数: 20～500 Hz</li>
                            </ul>
                            <p><strong>ローパスフィルタ (高音カット):</strong></p>
                            <ul>
                                <li>サーッという高音ノイズを除去</li>
                                <li>カットオフ周波数: 1000～20000 Hz</li>
                            </ul>
                        </div>
                    </div>
                    
                    <!-- 書き出し -->
                    <div class="help-content" data-help-content="export">
                        <h3>💾 書き出し</h3>
                        
                        <div class="help-section">
                            <h4>書き出し手順</h4>
                            <ol>
                                <li>ヘッダーの<strong>「書き出し」</strong>ボタンをクリック</li>
                                <li>ファイル形式を選択 (WAV または MP3)</li>
                                <li>サンプルレートとビットデプスを選択</li>
                                <li><strong>「書き出し開始」</strong>ボタンをクリック</li>
                                <li>ダウンロードが自動的に開始されます</li>
                            </ol>
                        </div>
                        
                        <div class="help-section">
                            <h4>推奨設定</h4>
                            <p><strong>高音質版 (マスター音源):</strong></p>
                            <ul>
                                <li>形式: WAV</li>
                                <li>サンプルレート: 48 kHz</li>
                                <li>ビットデプス: 24 bit</li>
                            </ul>
                            <p><strong>配信用:</strong></p>
                            <ul>
                                <li>形式: MP3</li>
                                <li>サンプルレート: 44.1 kHz または 48 kHz</li>
                                <li>ビットデプス: 16 bit</li>
                            </ul>
                        </div>
                        
                        <div class="help-section">
                            <h4>注意事項</h4>
                            <ul>
                                <li>書き出しには時間がかかる場合があります</li>
                                <li>ブラウザのポップアップブロックを解除してください</li>
                                <li>エフェクト処理もすべて適用されます</li>
                            </ul>
                        </div>
                    </div>
                    
                    <!-- 便利な機能 -->
                    <div class="help-content" data-help-content="tips">
                        <h3>💡 便利な機能・ヒント</h3>
                        
                        <div class="help-section">
                            <h4>キーボードショートカット</h4>
                            <ul>
                                <li><strong>スペース:</strong> 再生 / 一時停止</li>
                                <li><strong>Ctrl/Cmd + Z:</strong> 元に戻す</li>
                                <li><strong>Ctrl/Cmd + Y:</strong> やり直す</li>
                                <li><strong>Delete:</strong> 選択中のクリップを削除</li>
                            </ul>
                        </div>
                        
                        <div class="help-section">
                            <h4>ファイル管理のコツ</h4>
                            <ul>
                                <li>台詞ファイルは「台詞」タブに、BGMは「BGM」タブに分類すると管理しやすい</li>
                                <li>ファイル名は分かりやすいものにしておくと便利</li>
                                <li>不要なファイルは「-」ボタンで削除できます</li>
                            </ul>
                        </div>
                        
                        <div class="help-section">
                            <h4>トラックの整理</h4>
                            <ul>
                                <li>トラック名をダブルクリックして編集できます</li>
                                <li>用途別にトラックを分けると編集しやすくなります<br>
                                    (例: 「キャラA」「キャラB」「効果音」「BGM」など)</li>
                                <li>トラックの削除は、トラック名横の「✕」ボタンから</li>
                            </ul>
                        </div>
                        
                        <div class="help-section">
                            <h4>波形表示の活用</h4>
                            <ul>
                                <li>波形を見ることで、音の大きさやタイミングが分かります</li>
                                <li>無音部分を削除して、テンポよく編集できます</li>
                                <li>ズームを調整して、細かい編集が可能です</li>
                            </ul>
                        </div>
                        
                        <div class="help-section">
                            <h4>エフェクトの使い方のコツ</h4>
                            <ul>
                                <li>エフェクトは控えめに使うのがコツ</li>
                                <li>まずリミッターで音割れを防止</li>
                                <li>次にコンプレッサーで音量を均一に</li>
                                <li>最後にEQで音質を調整</li>
                                <li>ノイズが気になる場合は帯域カットを使用</li>
                            </ul>
                        </div>
                        
                        <div class="help-section">
                            <h4>パフォーマンスのヒント</h4>
                            <ul>
                                <li>大量のクリップを扱う場合、ズームアウトすると軽くなります</li>
                                <li>再生が重い場合は、エフェクトを一時的にオフに</li>
                                <li>定期的にプロジェクトを保存しましょう</li>
                            </ul>
                        </div>
                        
                        <div class="help-section">
                            <h4>トラブルシューティング</h4>
                            <ul>
                                <li><strong>音が出ない:</strong> ブラウザの音量設定を確認</li>
                                <li><strong>ファイルが読み込めない:</strong> 対応形式か確認 (MP3, WAV, OGG, M4A)</li>
                                <li><strong>書き出せない:</strong> ブラウザのポップアップブロックを解除</li>
                                <li><strong>動作が重い:</strong> ブラウザのタブを閉じて、メモリを解放</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="help-footer">
                    <label class="checkbox-label">
                        <input type="checkbox" id="dontShowHelpAgain">
                        <span>次回から自動的に表示しない</span>
                    </label>
                    <button class="btn btn-primary" id="closeHelpFooterBtn">閉じる</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ファイル入力（非表示） -->
    <input type="file" id="fileInput" multiple accept="audio/*" style="display: none;">
    
    <!-- クリップゲイン調整ポップアップ -->
    <div class="clip-gain-popup" id="clipGainPopup" style="display: none;">
        <div class="popup-header">
            <h3 id="clipGainTitle">🎚️ クリップゲイン</h3>
            <button class="btn-close" id="closeClipGainBtn">✕</button>
        </div>
        <div class="popup-content">
            <div class="gain-slider-container">
                <label>ゲイン調整</label>
                <input type="range" id="clipGainSlider" min="-24" max="24" value="0" step="0.1">
                <span class="gain-value" id="clipGainValue">0.0 dB</span>
            </div>
            <div class="gain-info">
                <div class="info-row">
                    <span>現在のピーク:</span>
                    <span id="clipCurrentPeak" class="info-value">-- dB</span>
                </div>
                <div class="info-row">
                    <span>調整後のピーク:</span>
                    <span id="clipAdjustedPeak" class="info-value">-- dB</span>
                </div>
            </div>
            <div class="gain-presets">
                <button class="btn btn-small gain-preset-btn" data-value="0">0dB</button>
                <button class="btn btn-small gain-preset-btn" data-value="3">+3dB</button>
                <button class="btn btn-small gain-preset-btn" data-value="6">+6dB</button>
                <button class="btn btn-small gain-preset-btn" data-value="-3">-3dB</button>
                <button class="btn btn-small gain-preset-btn" data-value="-6">-6dB</button>
            </div>
        </div>
    </div>

    <script src="audioEngine.js"></script>
    <script src="projectManager.js"></script>
    <script src="historyManager.js"></script>
    <script src="trackManager.js"></script>
    <script src="fileManager.js"></script>
    <script src="effectsManager.js"></script>
    <script src="exportManager.js"></script>
    <script src="sliderUtils.js"></script>
    <script src="helpSystem.js"></script>
    <script src="app.js"></script>
</body>
</html>
